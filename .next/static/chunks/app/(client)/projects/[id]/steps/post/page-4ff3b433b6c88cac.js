(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[841],{4656:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});var r=s(5155),a=s(5239),i=s(2115),l=s(63);function n(){let e=(0,l.useParams)().id,t=(0,l.useRouter)(),[s,n]=(0,i.useState)([]),[c,o]=(0,i.useState)(""),[d,p]=(0,i.useState)(null);(0,i.useEffect)(()=>{e&&(async()=>{try{let t=await fetch("/api/projects/".concat(e,"/steps/generate"));if(!t.ok)throw Error("ステップの取得に失敗しました");let s=await t.json();n(s)}catch(e){console.error(e),o("ステップの取得に失敗しました")}})()},[e]);let x=async r=>{if(r.preventDefault(),s.some(e=>""===e.title.trim()))return void o("タイトルを入力してください");o("");try{await fetch("/api/projects/".concat(e,"/steps"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}),await fetch("/api/projects/".concat(e,"/tasks/generate"),{method:"POST"}),t.push("/projects/".concat(e,"/created-success"))}catch(e){console.error("保存または生成エラー:",e),o("保存または生成に失敗しました")}};return(0,r.jsx)("div",{className:"min-h-screen min-w-screen bg-[#EBEEF1] flex justify-center text-gray-950",children:(0,r.jsx)("div",{className:"p-6 bg-white relative",style:{width:"335px",height:"752px",marginTop:"30px"},children:(0,r.jsxs)("form",{onSubmit:x,className:"grid",style:{width:"295px",rowGap:"24px",marginTop:"30px"},children:[(0,r.jsxs)("div",{className:"text-center font-medium",children:["スケジュール生成のために",(0,r.jsx)("br",{}),"ステップを編集してください"]}),(0,r.jsxs)("div",{className:"grid",style:{gridTemplateRows:"auto auto",rowGap:"8px",borderRadius:"0px",height:"344px"},children:[(0,r.jsxs)("div",{className:"grid font-semibold text-center border-b",style:{gridTemplateColumns:"24px 24px 176px auto"},children:[(0,r.jsx)("div",{})," ",(0,r.jsx)("div",{}),(0,r.jsx)("div",{children:"ステップ名"}),(0,r.jsx)("div",{})," "]}),(0,r.jsx)("div",{style:{overflowY:"auto",height:"calc(344px - 24px)"},children:s.map((e,t)=>(0,r.jsx)("div",{className:"p-2",draggable:!0,onDragStart:()=>p(t),onDragOver:e=>e.preventDefault(),onDrop:()=>(e=>{if(null===d)return;let t=[...s],[r]=t.splice(d,1);t.splice(e,0,r),n(t.map((e,t)=>({...e,index:t}))),p(null)})(t),children:(0,r.jsxs)("div",{className:"grid items-center gap-2",style:{gridTemplateColumns:"24px 24px 176px auto"},children:[(0,r.jsx)("span",{className:"cursor-grab text-center",style:{minWidth:"24px"},children:"≡"}),(0,r.jsx)("span",{className:"text-center",style:{minWidth:"24px"},children:e.index+1}),(0,r.jsx)("input",{type:"text",value:e.title,onChange:e=>((e,t,r)=>{let a=[...s];"index"===t?a[e][t]=Number(r):a[e][t]=r,n(a)})(t,"title",e.target.value),placeholder:"タイトル",className:"p-2 border",style:{borderRadius:"0px",width:"176px"}}),(0,r.jsx)("div",{style:{minWidth:"24px",marginLeft:"4px"},children:s.length>1&&(0,r.jsx)("button",{type:"button",onClick:()=>{n(s.filter((e,s)=>s!==t).map((e,t)=>({...e,index:t})))},className:"text-red-500 font-bold",style:{minWidth:"24px"},children:(0,r.jsx)(a.default,{src:"/createWeights/trashBox.svg",alt:"delete Step",width:24,height:24,className:"cursor-pointer hover:opacity-80"})})})]})},e.index))})]}),(0,r.jsx)("div",{className:"flex justify-center",children:(0,r.jsx)("button",{type:"button",onClick:()=>{n([...s,{index:s.length,title:"",theme:""}])},className:"font-semibold",style:{borderRadius:"0px"},children:(0,r.jsx)(a.default,{src:"/createWeights/plusButton.svg",alt:"Add Step",width:45,height:45,className:"cursor-pointer hover:opacity-80"})})}),c&&(0,r.jsx)("p",{className:"text-red-500 text-sm text-center",children:c}),(0,r.jsx)("button",{type:"submit",className:"font-semibold transition absolute left-1/2 transform -translate-x-1/2",style:{width:"226px",height:"60px",borderRadius:"0px",backgroundColor:"#3C436D",color:"#FFFFFF",top:"611px"},children:"決定"})]})})})}},5175:(e,t,s)=>{Promise.resolve().then(s.bind(s,4656))}},e=>{e.O(0,[394,441,493,358],()=>e(e.s=5175)),_N_E=e.O()}]);